"use strict";function arrayLastElement(a){return a[a.length-1]}Date.a||(Date.a=function(){return(new Date).getTime()}),function(){function a(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.addEventListener("load",b),d.addEventListener("error",c),d.send()}function b(a,b){"granted"===window.Notification.permission&&m.c.b&&(l&&setTimeout(l.close.bind(l),5e3),l=new window.Notification(b,{d:a}))}function c(){return window.Notification?void("granted"!==window.Notification.permission&&window.Notification.requestPermission()):alert("Notifications not supported.")}var d,e,f=2,g=new Date,h=g.getDay(),i="RL Schedule",j={e:function(a){return this.f[a]||(this.f[a]=document.getElementById(a))},f:{}},k={g:function(a){return this.h=void 0!==a.i,this.h?(this.j(a),this.k(),void this.l()):this.m()},j:function(a){this.i=a.i,this.n=a.n,"Hall"===this.i[1].name&&(this.n=this.o(this.i[1].p)-this.o(this.i[1].q)),this.r=1,this.n&&"Hall"===this.i[1].name&&this.r++,this.s=this.i[this.r].t,this.u=this.s,this.n&&(this.u+="-"+this.n),this.v=a.v||(this.n>=45?3:4)},w:function(){f++,j.e("periods-list").x="Sorry, there has been an error. Please try reloading soon.",j.e("periods-list").style.y="block"},m:function(){var a;a=6===h||0===h?"Weekend":"No School",j.e("current-title").x=a},k:function(){for(var a=document.createDocumentFragment(),b=this.i.length,c=0,d=0;d<b;d++){var e=this.i[d];e.z=this.o(e.q),e.A=this.o(e.p),e.period===this.v&&(e.B=c++);var f=document.createElement("div");f.C="list-item";var g=document.createElement("span");g.C="list-item-letter",g.x=this.D(e),f.appendChild(g);var h=document.createElement("span");h.C="list-item-time",h.x=this.E(e.z)+"-"+this.E(e.A),f.appendChild(h),a.appendChild(f)}this.F=a,j.e("periods-list-heading").x=this.u,j.e("periods-list-blocks").appendChild(this.F),j.e("periods-list").style.y="block",j.e("about").style.y="block",this.G=j.e("periods-list-blocks").H},l:function(){--f||(this.q=this.i[0].z,this.p=arrayLastElement(this.i).A,this.I(!0))},D:function(a){return a.period===this.v?a.t+" - "+this.J[a.B]:a.t||a.name},K:function(){return 6===arrayLastElement(this.i).period},L:function(a){return this.D(this.i[this.M+a])},N:function(){if(void 0===this.M)for(var a=0;a<this.i.length;a++){var b=this.i[a];if(e>=b.z&&e<b.A+5){this.M=a;break}}else this.G[this.M].classList.remove("period-highlight"),this.M++;this.O=this.i[this.M].A-e,this.G[this.M].classList.add("period-highlight")},I:function(a){var c,f,k,l;g.setTime(Date.a()),d=g.getDay(),d!==h&&window.location.reload(),a?e=this.o(g.getHours(),g.getMinutes()):e++,e>=this.p?(document.d=i,f="After school",k=5!==d?"Tomorrow starts with "+this.P()+" block.":"The next school day starts with "+this.P()+" block.",this.M&&this.G[this.M].classList.remove("period-highlight"),l=!0):e<this.q?(f="Before school",c=this.Q(this.q-e),k=this.R(c.S,"hour"," ","")+this.R(c.T,"minute"," ")+"until homeroom."):(this.O===-4||void 0===this.O?(this.N(a),f=this.L(0)):this.O--,this.O<=0?(k="Passing time: "+this.R(this.O+5,"minute")+" until "+this.L(1),0===this.O&&(document.d=i,b(i,this.L(1)+" starts in 5 minutes."))):(k=this.R(this.O,"minute")+" left",document.d=i+" ("+this.O+")"),5===this.O&&b(i,"5 minutes left in "+this.L(0))),f&&(j.e("current-title").x=f),k&&(j.e("current-description").x=k),l||setTimeout(this.I.bind(this),6e4-1e3*g.getSeconds())},P:function(){var a="HGFEDCBA",b=a.indexOf(this.s)+1+this.K();return a[b%8]},o:function(a,b){if("string"==typeof a){var c=a.split(":");return 60*c[0]+1*c[1]}if("number"==typeof a)return 60*a+1*b},Q:function(a){return{S:Math.floor(a/60),T:a%60}},E:function(a){var b=this.Q(a);return b.T<10&&(b.T="0"+b.T),(b.S%12||12)+":"+b.T},R:function(a,b,c,d){return 0===a?d||"":1===a?a+" "+b+(c||""):a+" "+b+"s"+(c||"")},J:["First Lunch","In Between Lunches","Second Lunch"]};a("//casper.roxburylatin.org/todays_schedule.json",function(){k.g(JSON.parse(this.responseText))},k.w),addEventListener("DOMContentLoaded",function n(){removeEventListener("DOMContentLoaded",n),k.l(),m.U(),j.e("settings-button").addEventListener("click",m.V.bind(m))});var l,m={c:{b:!1},U:function(){this.c=JSON.parse(localStorage.getItem("settings"))||this.c},W:function(){var a;this.X=j.e("settings").getElementsByTagName("input");for(var b=0;b<this.X.length;b++)a=this.X[b],a.Y=this.c[a.getAttribute("data-rep")];j.e("settings-submit").addEventListener("click",this.Z.bind(this)),this.$=!0},_:function(){for(var a,b=0;b<this.X.length;b++)a=this.X[b],this.c[a.getAttribute("data-rep")]=a.Y;localStorage.setItem("settings",JSON.stringify(this.c)),this.c.b&&c()},Z:function(){this._(),this.V()},V:function(){this.$||this.W(),j.e("settings").classList.V("appear")}}}();
