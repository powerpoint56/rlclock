"use strict";Date.now||(Date.now=function(){return(new Date).getTime()}),640<screen.width&&document.documentElement.classList.add("hoverable"),addEventListener("ontouchstart",function t(){document.documentElement.classList.remove("hoverable"),removeEventListener("ontouchstart",t)}),function(h,s){var n,t=2,r=new Date,i=r.getDay(),o=0,u="RL Schedule";function e(t){return t[t.length-1]}var a={id:function(t){return this.elements[t]||(this.elements[t]=h.getElementById(t))},elements:{}},c={t:function(t){if(this.i=!!t.periods,!this.i)return this.s();this.h(t),this.o(),this.u()},h:function(t){this.periods=t.periods,this.hallLength=t.hallLength,"Hall"===this.periods[1].name&&(this.hallLength=this.l(this.periods[1].end)-this.l(this.periods[1].start)),this.m=1,this.hallLength&&"Hall"===this.periods[1].name&&this.m++,this.p=this.periods[this.m].block,this.v=this.p,this.hallLength&&(this.v+="-"+this.hallLength),this.lunchPeriod=t.lunchPeriod||(45<=this.hallLength?3:4),5===i&&(s.localStorage.setItem("next-day",this.g()),s.localStorage.setItem("next-day-rec",r.getDate()))},error:function(){t++,a.id("periods-list").textContent="Sorry, there has been an error. Please try reloading soon.",a.id("periods-list").classList.remove("hide")},s:function(){var t;t=6===i||0===i?"Weekend":"No School",a.id("current-title").textContent=t,a.id("current-description").textContent=this.k()},o:function(){for(var t=h.createDocumentFragment(),i=this.periods.length,s=0,e=0;e<i;e++){var n=this.periods[e];n.D=this.l(n.start),n.L=this.l(n.end),n.period===this.lunchPeriod&&"Hall"!==n.name&&(n.M=s++),t.appendChild(this.S(this.T(n),this.N(n.D)+"-"+this.N(n.L)))}this.O(t,this.v)},S:function(t,i){var s=h.createElement("div");s.className="list-item";var e=h.createElement("span");e.className="list-item-letter",e.textContent=t,s.appendChild(e);var n=h.createElement("span");return n.className="list-item-time",n.textContent=i,s.appendChild(n),s},O:function(t,i){this.H=t,a.id("periods-list-heading").textContent=i,a.id("periods-list-blocks").appendChild(this.H),a.id("periods-list").classList.remove("hide"),this.P=a.id("periods-list-blocks").childNodes},u:function(){--t||(this.start=this.periods[0].D,this.end=e(this.periods).L,this.update(!0))},T:function(t){return t.period===this.lunchPeriod&&"Hall"!==t.name?t.block+" - "+this.B[t.M]:t.block||t.name},R:function(){return 6===e(this.periods).period},A:function(t){return this.T(this.periods[this.C+t])},J:function(){if(void 0===this.C)for(var t=0;t<this.periods.length;t++){var i=this.periods[t];if(o>=i.D&&o<i.L+5){this.C=t;break}}else this.P[this.C].classList.remove("period-highlight"),this.C++;this.j=this.periods[this.C].L-o,this.P[this.C].classList.add("period-highlight")},update:function(){var t,i,s,e;r.setTime(Date.now()),n=r.getDay(),(o=this.l(r.getHours(),r.getMinutes()))>=this.end?(h.title=u,i="After school",s=this.k(),this.C&&this.P[this.C].classList.remove("period-highlight"),e=!0):o<this.start?(i="Before school",t=this.F(this.start-o),s=this.G(t._,"hour"," ","")+this.G(t.q,"minute"," ")+"until homeroom."):(-4===this.j||void 0===this.j?(this.J(),i=this.A(0)):this.j--,this.j<=0?(s="Passing time: "+this.G(this.j+5,"minute")+" until "+this.A(1),0===this.j&&m(h.title=u,this.A(1)+" starts in 5 minutes.")):(s=this.G(this.j,"minute")+" left",h.title="("+this.j+") "+u),5===this.j&&m(u,"5 minutes left in "+this.A(0))),i&&(a.id("current-title").textContent=i),s&&(a.id("current-description").textContent=s),e||setTimeout(this.update.bind(this),6e4-1e3*r.getSeconds())},g:function(){if(this.p){var t="HGFEDCBA",i=t.indexOf(this.p)+1+this.R();return t[i%8]}return Math.abs(r.getDate()-s.localStorage.getItem("next-day-rec"))<5?s.localStorage.getItem("next-day"):0},k:function(){var t=this.g();return t?(0<n&&n<5?"Tomorrow":"The next school day")+" starts with "+t+" block.":""},l:function(t,i){if("number"==typeof t)return 60*t+1*i;if("string"==typeof t){var s=t.split(":");return 60*s[0]+1*s[1]}},F:function(t){return{_:Math.floor(t/60),q:t%60}},N:function(t){var i=this.F(t);return i.q<10&&(i.q="0"+i.q),(i._%12||12)+":"+i.q},G:function(t,i,s,e){return 0===t?e||"":1===t?t+" "+i+(s||""):t+" "+i+"s"+(s||"")},B:["First Lunch","In Between Lunches","Second Lunch"]};function d(t,i,s){var e=new XMLHttpRequest;e.open("GET",t),e.addEventListener("load",i),e.addEventListener("error",s),e.send()}d("rlclock.ml"===s.location.hostname?"//casper.roxburylatin.org/todays_schedule.json":"todays_schedule.json",function(){c.t(JSON.parse(this.responseText))},c.error),addEventListener("DOMContentLoaded",function t(){if(removeEventListener("DOMContentLoaded",t),c.u(),f.load(),a.id("settings-button").addEventListener("click",f.toggle.bind(f)),a.id("about-toggle").addEventListener("click",function(t){return t.preventDefault(),a.id("about-more").textContent?a.id("about-more").classList.toggle("hide"):d("about.txt",function(){a.id("about-more").textContent=this.responseText}),!1}),!s.localStorage.getItem("domain")){var i=a.id("banner");i.classList.remove("fade"),i.addEventListener("click",function(){s.localStorage.setItem("domain",1),i.classList.add("fade")})}}),addEventListener("visibilitychange",function(){h.hidden||c.update()});var l,f={data:{I:!1},load:function(){this.data=JSON.parse(s.localStorage.getItem("settings"))||this.data,!1!==this.data.U&&(this.data.U||19<=r.getHours()||r.getHours()<=6)&&(a.id("dark").checked=!0,a.id("settings-form").querySelector('[data-rep="dark"]').checked=!0)},W:function(){var t;this.X=a.id("settings").getElementsByTagName("input");for(var i=0;i<this.X.length;i++)(t=this.X[i]).checked=this.data[t.getAttribute("data-rep")];a.id("settings-submit").addEventListener("click",this.submit.bind(this)),this.K=!0},save:function(){for(var t,i=0;i<this.X.length;i++)t=this.X[i],this.data[t.getAttribute("data-rep")]=t.checked;s.localStorage.setItem("settings",JSON.stringify(this.data)),this.data.I&&function(){if(!s.Notification)return alert("Notifications not supported.");if("granted"===s.Notification.permission)return;s.Notification.requestPermission()}(),a.id("dark").checked=this.data.U},submit:function(){this.save(),this.toggle()},toggle:function(){this.K||this.W(),a.id("settings").classList.toggle("appear")}};function m(t,i){"granted"===s.Notification.permission&&f.data.I&&(l&&setTimeout(l.close.bind(l),5e3),l=new s.Notification(i,{title:t}))}}(document,window);